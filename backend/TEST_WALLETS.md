# 测试钱包地址支持

后端已支持测试钱包地址，用于 Playwright E2E 测试。

## 测试钱包地址列表

默认支持的测试钱包地址：

- `0x1111111111111111111111111111111111111111`
- `0x2222222222222222222222222222222222222222`
- `0x3333333333333333333333333333333333333333`
- `0x4444444444444444444444444444444444444444`
- `0x5555555555555555555555555555555555555555`

## 工作原理

1. **配置加载**：测试钱包地址列表在 `config/config.go` 中定义，默认包含上述5个地址。

2. **签名验证**：
   - 对于**测试钱包地址**：只验证签名格式（130个十六进制字符），不验证签名内容
   - 对于**真实钱包地址**：进行完整的以太坊签名验证

3. **环境变量支持**：可以通过环境变量 `TEST_WALLETS` 覆盖默认的测试钱包列表（逗号分隔）

## 配置方式

### 方式1：使用默认配置（推荐）

默认配置已包含测试钱包地址，无需额外配置。

### 方式2：通过环境变量配置

```bash
export TEST_WALLETS="0x1111111111111111111111111111111111111111,0x2222222222222222222222222222222222222222"
```

### 方式3：通过配置文件配置（未来支持）

可以在 `config.yaml` 中添加测试钱包配置（当前版本暂不支持YAML配置）。

## 代码修改说明

### 1. `config/config.go`

- 添加了 `TestWallets []string` 字段到 `Config` 结构体
- 在默认配置中添加了5个测试钱包地址
- 支持从环境变量 `TEST_WALLETS` 读取测试钱包列表

### 2. `services/participant_service.go`

- 添加了 `isTestWallet()` 方法：检查钱包地址是否为测试钱包
- 添加了 `isValidTestSignature()` 方法：验证测试钱包签名格式
- 修改了 `VerifySignature()` 方法：对测试钱包跳过实际签名验证，只验证格式

## 安全说明

⚠️ **重要**：测试钱包地址只在开发和测试环境中使用，生产环境应禁用或严格限制。

建议在生产环境中：
1. 通过环境变量清空测试钱包列表
2. 或者在配置中移除测试钱包地址

## 使用示例

测试钱包地址的使用方式与真实钱包地址完全相同：

1. 调用 `/api/v1/auth/connect` 获取 nonce
2. 调用 `/api/v1/auth/verify` 验证签名（测试钱包可以使用任意130字符的十六进制签名）

示例签名格式（测试钱包可以使用）：
```
0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
```

## 测试

运行 Playwright 测试时，测试钱包地址会自动被识别为测试钱包，跳过签名验证，确保测试可以正常进行。

