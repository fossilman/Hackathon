# Admin系统权限管理矩阵

## 文档说明
本文档根据 PRD-101M 需求文档，细化 Admin 系统中各角色的页面访问权限和操作权限。

**文档版本**: v1.1  
**创建日期**: 2024-01-XX  
**最后更新**: 2024-01-XX  
**基于文档**: PRD-101M

---

## 1. 角色定义

| 角色 | 描述 | 登录方式 |
|------|------|----------|
| **Admin** | 系统超级管理员，拥有最高权限 | 账号密码登录 |
| **主办方（Organizer）** | 负责创建和管理 Hackathon 活动的组织或个人 | 账号密码登录 |
| **赞助商（Sponsor）** | 为 Hackathon 活动提供赞助的企业或组织 | 账号密码登录 |

---

## 2. 页面访问权限矩阵

| 页面/模块 | Admin | 主办方 | 赞助商 | 说明 |
|-----------|-------|--------|--------|------|
| **登录页面** | ✅ | ✅ | ✅ | 所有角色均可访问 |
| **人员管理页面** | ✅ | ❌ | ❌ | 仅Admin可访问 |
| **活动列表页面** | ✅ | ✅ | ❌ | Admin和主办方可访问，赞助商第一期不可访问 |
| **活动创建/编辑页面** | ❌ | ✅ | ❌ | 仅主办方可访问 |
| **活动详情页面** | ✅ | ✅ | ❌ | Admin可查看，主办方可查看和管理 |
| **活动阶段管理页面** | ❌ | ✅ | ❌ | 仅主办方可访问 |
| **个人中心/设置页面** | ✅ | ✅ | ✅ | 所有角色均可访问自己的信息 |

---

## 3. 详细操作权限矩阵

### 3.1 用户认证模块

| 操作 | Admin | 主办方 | 赞助商 | 备注 |
|------|-------|--------|--------|------|
| **登录** | ✅ | ✅ | ✅ | 账号密码登录 |
| **登出** | ✅ | ✅ | ✅ | 所有角色均可登出 |
| **修改密码** | ✅ | ✅ | ✅ | 所有角色可修改自己的密码 |
| **查看个人信息** | ✅ | ✅ | ✅ | 所有角色可查看自己的信息 |

---

### 3.2 人员管理模块（仅Admin）

| 操作 | Admin | 主办方 | 赞助商 | 备注 |
|------|-------|--------|--------|------|
| **查看人员列表** | ✅ | ❌ | ❌ | 显示所有人员（主办方、赞助商） |
| **按角色筛选人员** | ✅ | ❌ | ❌ | 支持按主办方/赞助商筛选 |
| **按姓名/邮箱搜索** | ✅ | ❌ | ❌ | 支持搜索功能 |
| **分页查看人员** | ✅ | ❌ | ❌ | 支持分页显示 |
| **添加主办方人员** | ✅ | ❌ | ❌ | 必填：姓名、邮箱、密码、角色、手机号 |
| **添加赞助商人员** | ✅ | ❌ | ❌ | 必填：姓名、邮箱、密码、角色、所属赞助商、手机号 |
| **编辑人员信息** | ✅ | ❌ | ❌ | 可修改姓名、手机号，不可修改邮箱和角色 |
| **删除人员** | ✅ | ❌ | ❌ | 删除前需二次确认，建议软删除 |
| **查看人员详情** | ✅ | ❌ | ❌ | 查看人员完整信息 |

---

### 3.3 活动管理模块

#### 3.3.1 活动列表操作

| 操作 | Admin | 主办方 | 赞助商 | 备注 |
|------|-------|--------|--------|------|
| **查看活动列表** | ✅ | ✅ | ❌ | 显示所有活动 |
| **按活动状态筛选** | ✅ | ✅ | ❌ | 筛选：预备、发布、报名、签到、组队、提交、投票、公布结果 |
| **按活动名称搜索** | ✅ | ✅ | ❌ | 支持搜索功能 |
| **按创建时间排序** | ✅ | ✅ | ❌ | 升序/降序 |
| **分页查看活动** | ✅ | ✅ | ❌ | 支持分页显示 |
| **查看活动详情** | ✅ | ✅ | ❌ | 查看活动完整信息 |
| **批量操作（归档）** | ✅ | ⚠️ | ❌ | 仅活动创建者或Admin可以执行批量操作 |

#### 3.3.2 活动创建/编辑操作

| 操作 | Admin | 主办方 | 赞助商 | 备注 |
|------|-------|--------|--------|------|
| **创建活动** | ❌ | ✅ | ❌ | 仅主办方可创建 |
| **编辑活动（预备状态）** | ❌ | ⚠️ | ❌ | 仅活动创建者可以编辑，且活动状态为"预备"时可编辑所有字段 |
| **编辑活动（已发布）** | ❌ | ❌ | ❌ | 已发布的活动不可编辑 |
| **保存草稿** | ❌ | ⚠️ | ❌ | 仅活动创建者可以保存草稿 |
| **删除活动** | ❌ | ⚠️ | ❌ | 仅活动创建者可以删除，且仅可删除"预备"状态的活动，需二次确认 |
| **发布活动** | ❌ | ⚠️ | ❌ | 仅活动创建者可以发布，将活动从"预备"状态切换到"发布"状态 |
| **归档活动** | ✅ | ⚠️ | ❌ | 仅活动创建者或Admin可以归档，已发布的活动可归档（软删除） |

#### 3.3.3 活动详情查看

| 操作 | Admin | 主办方 | 赞助商 | 备注 |
|------|-------|--------|--------|------|
| **查看活动基本信息** | ✅ | ✅ | ❌ | 名称、描述、时间、地点、奖项等 |
| **查看活动当前阶段** | ✅ | ✅ | ❌ | 显示活动当前处于哪个阶段 |
| **查看阶段时间安排** | ✅ | ✅ | ❌ | 显示各阶段的开始和结束时间 |
| **查看活动统计信息** | ✅ | ✅ | ❌ | 报名人数、签到人数、组队数量、提交作品数量等 |
| **导出活动数据** | ✅ | ⚠️ | ❌ | 仅活动创建者或Admin可以导出活动相关数据 |

---

### 3.4 活动阶段管理模块（仅主办方）

| 操作 | Admin | 主办方 | 赞助商 | 备注 |
|------|-------|--------|--------|------|
| **查看阶段时间设置** | ❌ | ✅ | ❌ | 所有主办方可查看，但仅活动创建者可修改 |
| **设置报名阶段时间** | ❌ | ⚠️ | ❌ | 仅活动创建者可以设置 |
| **设置签到阶段时间** | ❌ | ⚠️ | ❌ | 仅活动创建者可以设置 |
| **设置组队阶段时间** | ❌ | ⚠️ | ❌ | 仅活动创建者可以设置 |
| **设置提交阶段时间** | ❌ | ⚠️ | ❌ | 仅活动创建者可以设置 |
| **设置投票阶段时间** | ❌ | ⚠️ | ❌ | 仅活动创建者可以设置 |
| **手动切换活动阶段** | ❌ | ⚠️ | ❌ | 仅活动创建者可以手动切换活动阶段 |
| **查看时间轴视图** | ❌ | ✅ | ❌ | 所有主办方可查看 |
| **时间冲突检测** | ❌ | ⚠️ | ❌ | 仅活动创建者设置时会进行冲突检测 |
| **查看阶段切换日志** | ❌ | ✅ | ❌ | 所有主办方可查看阶段切换的历史记录 |

---

## 4. 权限限制说明

### 4.1 Admin权限限制
- ✅ Admin可以查看所有活动，但**不能创建、编辑或删除活动**
- ✅ Admin可以归档已发布的活动（软删除）
- ✅ Admin可以管理所有人员（主办方、赞助商），但**不能修改自己的角色**
- ✅ Admin拥有最高权限，可以访问除活动创建/编辑外的所有页面

### 4.2 主办方权限限制
- ✅ 主办方可以查看所有活动，但**只能编辑、删除、发布自己创建的活动**
- ✅ 主办方可以创建新活动
- ✅ 主办方**不能管理人员**（不能添加、编辑、删除其他人员）
- ✅ 活动发布后，主办方**不能修改活动基本信息**（只能管理阶段）
- ✅ 只能删除处于"预备"状态的活动（且仅限自己创建的活动）
- ✅ 可以归档自己创建的已发布活动

### 4.3 赞助商权限限制
- ❌ 第一期功能待定，**仅能登录系统**
- ❌ 不能访问活动管理相关页面
- ❌ 不能访问人员管理页面
- ⚠️ **后续版本功能规划**：
  - 查看相关活动（可能包括查看自己赞助的活动）
  - 查看活动统计数据
  - 查看参与人数、报名人数等统计信息
  - 其他赞助商相关功能（待后续PRD定义）

---

## 5. 数据访问范围

| 数据类型 | Admin | 主办方 | 赞助商 | 说明 |
|----------|-------|--------|--------|------|
| **所有人员数据** | ✅ | ❌ | ❌ | Admin可查看所有人员 |
| **所有活动数据** | ✅ | ✅ | ❌ | Admin和主办方可查看所有活动 |
| **活动统计数据** | ✅ | ✅ | ❌ | 报名人数、签到人数等统计信息 |
| **阶段切换日志** | ✅ | ✅ | ❌ | 活动阶段切换的历史记录 |
| **个人账号信息** | ✅ | ✅ | ✅ | 所有角色可查看自己的信息 |

---

## 6. 特殊权限说明

### 6.1 活动编辑权限
- **预备状态**：仅活动创建者可以编辑所有字段
- **发布状态及后续**：活动创建者不能编辑活动基本信息，只能管理阶段
- **Admin**：不能编辑活动，只能查看
- **其他主办方**：可以查看活动，但不能编辑

### 6.2 活动删除权限
- **仅活动创建者**可以删除自己创建的活动
- **仅"预备"状态**的活动可以删除
- 删除前需**二次确认**
- 建议使用**软删除**，保留历史数据
- **Admin**：不能删除活动，但可以归档已发布的活动

### 6.3 人员管理权限
- **仅Admin**可以管理人员
- Admin可以添加、编辑、删除主办方和赞助商人员
- 编辑时**不能修改邮箱和角色**
- 删除前需**二次确认**

### 6.4 阶段管理权限
- **仅活动创建者**可以管理自己创建的活动阶段
- 可以设置各阶段的时间
- 可以手动切换阶段
- 系统可以自动切换阶段（基于时间设置）
- **其他主办方**：可以查看阶段信息，但不能修改

### 6.5 批量操作权限
- **仅活动创建者或Admin**可以执行批量操作（如批量归档）
- 批量操作前需确认权限
- 批量操作需记录操作日志

---

## 7. 已确认事项（v1.1更新）

### 7.1 活动数据访问范围 ✅
- **已确认**：所有主办方可以看到所有活动
- **已确认**：但只能编辑、删除、发布自己创建的活动
- **已确认**：活动创建者可以管理自己创建的活动阶段

### 7.2 Admin的活动管理权限 ✅
- **已确认**：Admin只能查看活动，不能创建、编辑或删除活动
- **已确认**：Admin可以归档已发布的活动（软删除）
- **已确认**：Admin不能执行活动删除操作

### 7.3 赞助商功能规划 ✅
- **已确认**：第一期功能待定，仅能登录系统
- **已规划**：后续版本可能包括：
  - 查看相关活动（可能包括查看自己赞助的活动）
  - 查看活动统计数据
  - 查看参与人数、报名人数等统计信息
  - 其他赞助商相关功能（待后续PRD定义）

### 7.4 批量操作权限 ✅
- **已确认**：仅活动创建者或Admin可以执行批量操作（如批量归档）
- **已确认**：批量操作前需确认权限
- **已确认**：批量操作需记录操作日志

---

## 8. 权限验证建议

### 8.1 前端权限控制
- 根据用户角色显示/隐藏菜单项和按钮
- 根据用户角色控制路由访问
- 在操作前进行权限校验

### 8.2 后端权限验证
- 所有API接口都需要进行权限验证
- 验证用户角色和操作权限
- **验证数据访问权限**：
  - 主办方只能编辑、删除、发布自己创建的活动
  - 活动创建者才能管理自己创建的活动阶段
  - Admin可以查看所有活动，但不能创建、编辑、删除
  - 批量操作需验证是否为活动创建者或Admin
- 记录操作日志，便于审计

### 8.3 数据权限控制
- 根据用户角色过滤数据
- 确保用户只能访问有权限的数据
- 防止越权访问

---

## 附录：页面路由建议

| 路由路径 | 页面名称 | Admin | 主办方 | 赞助商 |
|----------|----------|-------|--------|--------|
| `/login` | 登录页面 | ✅ | ✅ | ✅ |
| `/dashboard` | 仪表盘 | ✅ | ✅ | ❌ |
| `/users` | 人员管理 | ✅ | ❌ | ❌ |
| `/hackathons` | 活动列表 | ✅ | ✅ | ❌ |
| `/hackathons/create` | 创建活动 | ❌ | ✅ | ❌ |
| `/hackathons/:id` | 活动详情 | ✅ | ✅ | ❌ |
| `/hackathons/:id/edit` | 编辑活动 | ❌ | ⚠️ | ❌ | 仅活动创建者可访问 |
| `/hackathons/:id/stages` | 阶段管理 | ❌ | ⚠️ | ❌ | 仅活动创建者可访问 |
| `/profile` | 个人中心 | ✅ | ✅ | ✅ |
| `/settings` | 设置 | ✅ | ✅ | ✅ |

---

**文档维护说明**：
- 本文档基于 PRD-101M 需求文档整理
- 如有需求变更，请及时更新本文档
- 建议与开发团队确认权限细节后再实施

