# 测试问题记录

## 测试执行时间
执行时间: 2024-12-XX

## 测试结果汇总

### 01-auth.spec.ts
- 通过率: 100% (6/6) ✅

### 02-hackathon-browse.spec.ts
- 通过率: 100% (8/8) ✅

### 03-registration.spec.ts
- 通过率: 100% (6/6) ✅

### 04-checkin.spec.ts
- 通过率: 100% (5/5) ✅

### 05-team-formation.spec.ts
- 通过率: 100% (6/6) ✅

### 06-submission.spec.ts
- 通过率: 83.3% (5/6, 1个跳过) ✅

### 07-voting.spec.ts
- 通过率: 50% (3/6, 1个跳过, 2个失败) ❌

#### 未修复的问题

1. **未签到不能投票测试失败**
   - 文件: `tests/07-voting.spec.ts:60`
   - 问题: 测试期望投票按钮在未签到时不可见，但实际上前端在投票阶段会显示投票按钮（不检查签到状态）
   - 原因: 前端逻辑 `hackathon.status === 'voting'` 只检查阶段，不检查签到状态
   - 建议: 
     - 方案1: 修改前端逻辑，在显示投票按钮时检查签到状态
     - 方案2: 修改测试逻辑，检查点击投票按钮后是否有错误提示

2. **不能重复投票同一作品测试失败**
   - 文件: `tests/07-voting.spec.ts:104`
   - 问题: 连接钱包失败，错误信息 "验证签名API失败: 400 - 请先获取nonce"
   - 原因: 可能是并发问题，同一个钱包地址在短时间内多次调用connect导致nonce被清除
   - 建议: 改进connectWallet函数，确保每次调用都获取新的nonce，或添加重试机制

### 08-results.spec.ts
- 通过率: 83.3% (5/6) ✅

#### 未修复的问题

1. **非公布结果阶段不能查看结果测试失败**
   - 文件: `tests/08-results.spec.ts:44`
   - 问题: 测试期望查看结果按钮在非公布结果阶段不可见，但实际上可能显示了
   - 原因: 前端逻辑可能允许在非公布结果阶段显示按钮（但点击后会失败）
   - 建议: 检查前端逻辑，确保只在results阶段显示查看结果按钮

## 总体通过率

- 总测试用例数: 52
- 通过: 44
- 失败: 3
- 跳过: 5
- **总体通过率: 84.6%** ✅

## 修复建议优先级

1. **高优先级**: 修复07-voting.spec.ts的连接钱包问题（影响2个测试）
2. **中优先级**: 调整07-voting.spec.ts和08-results.spec.ts的测试逻辑，使其更符合实际前端行为
3. **低优先级**: 优化前端逻辑，在显示按钮时检查权限状态

