{
  "info": {
    "name": "Hackathon API Tests",
    "description": "Hackathon比赛平台API测试集合",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "admin_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "arena_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "hackathon_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "team_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "submission_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "wallet_address",
      "value": "0x1234567890123456789012345678901234567890",
      "type": "string"
    },
    {
      "key": "nonce",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Admin Platform",
      "item": [
        {
          "name": "Auth",
          "item": [
            {
              "name": "Login - Admin",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 200) {",
                      "    const jsonData = pm.response.json();",
                      "    if (jsonData.code === 200 && jsonData.data && jsonData.data.token) {",
                      "        pm.collectionVariables.set('admin_token', jsonData.data.token);",
                      "        pm.test('Login successful', function () {",
                      "            pm.expect(jsonData.data.token).to.be.a('string');",
                      "        });",
                      "    }",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"email\": \"admin@hackathon.com\",\n  \"password\": \"admin123456\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/api/v1/admin/auth/login",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "admin", "auth", "login"]
                }
              }
            },
            {
              "name": "Logout",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{admin_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/admin/auth/logout",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "admin", "auth", "logout"]
                }
              }
            }
          ]
        },
        {
          "name": "Users (Admin Only)",
          "item": [
            {
              "name": "Create User - Organizer",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "pm.test('Status code is 200', function () {",
                      "    pm.response.to.have.status(200);",
                      "});",
                      "pm.test('Response has correct structure', function () {",
                      "    const jsonData = pm.response.json();",
                      "    pm.expect(jsonData).to.have.property('code');",
                      "    pm.expect(jsonData).to.have.property('message');",
                      "    pm.expect(jsonData).to.have.property('data');",
                      "});"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{admin_token}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"测试主办方\",\n  \"email\": \"organizer{{$randomInt}}@test.com\",\n  \"password\": \"organizer123\",\n  \"role\": \"organizer\",\n  \"phone\": \"13800138000\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/api/v1/admin/users",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "admin", "users"]
                }
              }
            },
            {
              "name": "Get User List",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{admin_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/admin/users?page=1&page_size=10",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "admin", "users"],
                  "query": [
                    {
                      "key": "page",
                      "value": "1"
                    },
                    {
                      "key": "page_size",
                      "value": "10"
                    }
                  ]
                }
              }
            }
          ]
        },
        {
          "name": "Hackathons",
          "item": [
            {
              "name": "Create Hackathon",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 200) {",
                      "    const jsonData = pm.response.json();",
                      "    if (jsonData.code === 200 && jsonData.data && jsonData.data.id) {",
                      "        pm.collectionVariables.set('hackathon_id', jsonData.data.id.toString());",
                      "    }",
                      "}",
                      "pm.test('Status code is 200', function () {",
                      "    pm.response.to.have.status(200);",
                      "});"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{admin_token}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"2024春季Hackathon测试{{$randomInt}}\",\n  \"description\": \"这是一个测试活动\",\n  \"start_time\": \"2024-03-01T09:00:00+08:00\",\n  \"end_time\": \"2024-03-03T18:00:00+08:00\",\n  \"location_type\": \"online\",\n  \"max_team_size\": 3,\n  \"awards\": [\n    {\n      \"name\": \"一等奖\",\n      \"prize\": \"10000元\",\n      \"quantity\": 1,\n      \"rank\": 1\n    }\n  ],\n  \"stages\": [\n    {\n      \"stage\": \"registration\",\n      \"start_time\": \"2024-02-20T00:00:00+08:00\",\n      \"end_time\": \"2024-02-28T23:59:59+08:00\"\n    },\n    {\n      \"stage\": \"checkin\",\n      \"start_time\": \"2024-03-01T08:00:00+08:00\",\n      \"end_time\": \"2024-03-01T09:00:00+08:00\"\n    },\n    {\n      \"stage\": \"team_formation\",\n      \"start_time\": \"2024-03-01T09:00:00+08:00\",\n      \"end_time\": \"2024-03-01T18:00:00+08:00\"\n    },\n    {\n      \"stage\": \"submission\",\n      \"start_time\": \"2024-03-02T00:00:00+08:00\",\n      \"end_time\": \"2024-03-02T23:59:59+08:00\"\n    },\n    {\n      \"stage\": \"voting\",\n      \"start_time\": \"2024-03-03T00:00:00+08:00\",\n      \"end_time\": \"2024-03-03T17:00:00+08:00\"\n    }\n  ]\n}"
                },
                "url": {
                  "raw": "{{base_url}}/api/v1/admin/hackathons",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "admin", "hackathons"]
                }
              }
            },
            {
              "name": "Get Hackathon List",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{admin_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/admin/hackathons?page=1&page_size=10",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "admin", "hackathons"],
                  "query": [
                    {
                      "key": "page",
                      "value": "1"
                    },
                    {
                      "key": "page_size",
                      "value": "10"
                    }
                  ]
                }
              }
            },
            {
              "name": "Get Hackathon By ID",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{admin_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/admin/hackathons/{{hackathon_id}}",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "admin", "hackathons", "{{hackathon_id}}"]
                }
              }
            },
            {
              "name": "Publish Hackathon",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{admin_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/admin/hackathons/{{hackathon_id}}/publish",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "admin", "hackathons", "{{hackathon_id}}", "publish"]
                }
              }
            },
            {
              "name": "Switch Stage - Registration",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{admin_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/admin/hackathons/{{hackathon_id}}/stages/registration/switch",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "admin", "hackathons", "{{hackathon_id}}", "stages", "registration", "switch"]
                }
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Arena Platform",
      "item": [
        {
          "name": "Auth",
          "item": [
            {
              "name": "Connect Wallet",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 200) {",
                      "    const jsonData = pm.response.json();",
                      "    if (jsonData.code === 200 && jsonData.data && jsonData.data.nonce) {",
                      "        pm.collectionVariables.set('nonce', jsonData.data.nonce);",
                      "    }",
                      "}",
                      "pm.test('Status code is 200', function () {",
                      "    pm.response.to.have.status(200);",
                      "});"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"wallet_address\": \"0x1234567890123456789012345678901234567890\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/auth/connect",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "auth", "connect"]
                }
              }
            },
            {
              "name": "Verify Signature",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 200) {",
                      "    const jsonData = pm.response.json();",
                      "    if (jsonData.code === 200 && jsonData.data && jsonData.data.token) {",
                      "        pm.collectionVariables.set('arena_token', jsonData.data.token);",
                      "    }",
                      "}",
                      "pm.test('Status code is 200', function () {",
                      "    pm.response.to.have.status(200);",
                      "});"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"wallet_address\": \"0x1234567890123456789012345678901234567890\",\n  \"signature\": \"0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/auth/verify",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "auth", "verify"]
                }
              }
            }
          ]
        },
        {
          "name": "Hackathons",
          "item": [
            {
              "name": "Get Hackathon List",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons?page=1&page_size=10",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons"],
                  "query": [
                    {
                      "key": "page",
                      "value": "1"
                    },
                    {
                      "key": "page_size",
                      "value": "10"
                    }
                  ]
                }
              }
            },
            {
              "name": "Get Hackathon By ID",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons/{{hackathon_id}}",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons", "{{hackathon_id}}"]
                }
              }
            }
          ]
        },
        {
          "name": "Registration",
          "item": [
            {
              "name": "Register",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{arena_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons/{{hackathon_id}}/register",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons", "{{hackathon_id}}", "register"]
                }
              }
            },
            {
              "name": "Get Registration Status",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{arena_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons/{{hackathon_id}}/registration-status",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons", "{{hackathon_id}}", "registration-status"]
                }
              }
            }
          ]
        },
        {
          "name": "Checkin",
          "item": [
            {
              "name": "Checkin",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{arena_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons/{{hackathon_id}}/checkin",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons", "{{hackathon_id}}", "checkin"]
                }
              }
            },
            {
              "name": "Get Checkin Status",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{arena_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons/{{hackathon_id}}/checkin-status",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons", "{{hackathon_id}}", "checkin-status"]
                }
              }
            }
          ]
        },
        {
          "name": "Teams",
          "item": [
            {
              "name": "Create Team",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 200) {",
                      "    const jsonData = pm.response.json();",
                      "    if (jsonData.code === 200 && jsonData.data && jsonData.data.id) {",
                      "        pm.collectionVariables.set('team_id', jsonData.data.id.toString());",
                      "    }",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{arena_token}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"测试队伍\",\n  \"max_size\": 3\n}"
                },
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons/{{hackathon_id}}/teams",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons", "{{hackathon_id}}", "teams"]
                }
              }
            },
            {
              "name": "Get Team List",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{arena_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons/{{hackathon_id}}/teams",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons", "{{hackathon_id}}", "teams"]
                }
              }
            },
            {
              "name": "Get Team By ID",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{arena_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/teams/{{team_id}}",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "teams", "{{team_id}}"]
                }
              }
            }
          ]
        },
        {
          "name": "Submissions",
          "item": [
            {
              "name": "Create Submission",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 200) {",
                      "    const jsonData = pm.response.json();",
                      "    if (jsonData.code === 200 && jsonData.data && jsonData.data.id) {",
                      "        pm.collectionVariables.set('submission_id', jsonData.data.id.toString());",
                      "    }",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{arena_token}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"测试作品\",\n  \"description\": \"这是一个测试作品描述\",\n  \"link\": \"https://github.com/test/project\",\n  \"draft\": false\n}"
                },
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons/{{hackathon_id}}/submissions",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons", "{{hackathon_id}}", "submissions"]
                }
              }
            },
            {
              "name": "Get Submission List",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{arena_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons/{{hackathon_id}}/submissions",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons", "{{hackathon_id}}", "submissions"]
                }
              }
            }
          ]
        },
        {
          "name": "Votes",
          "item": [
            {
              "name": "Vote",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{arena_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/submissions/{{submission_id}}/vote",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "submissions", "{{submission_id}}", "vote"]
                }
              }
            },
            {
              "name": "Get My Votes",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{arena_token}}"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons/{{hackathon_id}}/votes",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons", "{{hackathon_id}}", "votes"]
                }
              }
            }
          ]
        },
        {
          "name": "Results",
          "item": [
            {
              "name": "Get Results",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/v1/arena/hackathons/{{hackathon_id}}/results",
                  "host": ["{{base_url}}"],
                  "path": ["api", "v1", "arena", "hackathons", "{{hackathon_id}}", "results"]
                }
              }
            }
          ]
        }
      ]
    }
  ]
}

